---
title: Server Actions Reference
description: Complete reference for BAML-generated Next.js server actions
---

This reference documentation covers the server actions generated by BAML for Next.js applications. For a step-by-step guide on getting started, see the [Quick Start Guide](/guide/frameworks/react-nextjs/quick-start).

## Generated Types

BAML generates two variants of server actions for each BAML function:

<CodeBlocks>
```typescript Type Definitions
// Regular server action
// Location: @/baml_client/react/server
type ServerAction<Input, Output> = (
  ...args: Input extends any[] ? Input : [Input]
) => Promise<Output>

// Streaming server action
// Location: @/baml_client/react/server_streaming
type StreamingServerAction<Input, Output> = (
  ...args: Input extends any[] ? Input : [Input]
) => Promise<ReadableStream<Uint8Array>>
```
</CodeBlocks>

### Hook Types

When using server actions with React hooks, the following types are available:

<CodeBlocks>
```typescript Hook Types
// Hook result type
interface HookResult<TData> {
  // Response data
  data?: TData                    // Final response
  partialData?: Partial<TData>    // Streaming updates

  // Status flags
  isLoading: boolean             // Request in progress
  isPending: boolean             // Request pending
  isSuccess: boolean             // Request completed
  isError: boolean               // Request failed

  // Action trigger
  mutate: (...args: any[]) => Promise<void>
}

// Hook configuration
interface HookProps<TData> {
  stream?: boolean               // Enable streaming mode
  onSuccess?: (data: TData) => void
  onError?: (error: Error) => void
  onPartial?: (partial: Partial<TData>) => void
}
```
</CodeBlocks>

## Server Action Usage

### Direct Server Usage

Use server actions directly in server components or server-side code:

<CodeBlocks>
```typescript Server Component
// app/page.tsx
import { WriteMeAStory } from '@/baml_client/react/server'

export default async function Page() {
  const story = await WriteMeAStory("dragons")
  return <div>{story}</div>
}
```

```typescript Form Action
// app/form.tsx
'use server'
import { WriteMeAStory } from '@/baml_client/react/server'

export async function submitForm(formData: FormData) {
  const topic = formData.get('topic')
  return WriteMeAStory(topic)
}
```
</CodeBlocks>

### Client-Side Usage

Access server actions from client components using the generated hooks:

<CodeBlocks>
```typescript Regular Hook
'use client'
import { useWriteMeAStory } from "@/baml_client/react/hooks"

export function StoryGenerator() {
  const { data, error, isLoading, mutate } = useWriteMeAStory()

  return (
    <button
      onClick={() => mutate("dragons")}
      disabled={isLoading}
    >
      Generate Story
    </button>
  )
}
```

```typescript Streaming Hook
'use client'
import { useWriteMeAStory } from "@/baml_client/react/hooks"

export function StreamingStory() {
  const {
    data: finalStory,
    partialData: streamingStory,
    isLoading,
    mutate
  } = useWriteMeAStory({
    stream: true,
    onPartial: (partial) => {
      console.log('Update:', partial)
    }
  })

  return (
    <div>
      {streamingStory && <div>Writing: {streamingStory}</div>}
      {finalStory && <div>Final: {finalStory}</div>}
    </div>
  )
}
```
</CodeBlocks>

## Error Handling

Server actions provide type-safe error handling through specific error types:

<CodeBlocks>
```typescript Error Types
import {
  BamlValidationError,      // Input validation errors
  BamlClientFinishReasonError  // LLM-specific errors
} from "@boundaryml/baml"

try {
  await WriteMeAStory("dragons")
} catch (err) {
  if (err instanceof BamlValidationError) {
    // Handle validation errors
  } else if (err instanceof BamlClientFinishReasonError) {
    // Handle LLM errors (e.g. context length)
  }
}
```
</CodeBlocks>

## Integration Patterns

### Authentication

Wrap server actions with authentication checks:

<CodeBlocks>
```typescript Auth Wrapper
// app/actions/story.ts
'use server'

import { auth } from '@/lib/auth'
import { WriteMeAStory } from '@/baml_client/react/server'

export async function generateStoryWithAuth(topic: string) {
  const session = await auth()
  if (!session) throw new Error('Unauthorized')

  return WriteMeAStory(topic)
}
```
</CodeBlocks>

### Database Integration

Add database logging or persistence:

<CodeBlocks>
```typescript Database Integration
// app/actions/story.ts
'use server'

import { db } from '@/lib/db'
import { WriteMeAStory } from '@/baml_client/react/server'

export async function generateStoryWithLogging(topic: string) {
  const request = await db.requests.create({
    data: { topic, timestamp: new Date() }
  })

  try {
    const story = await WriteMeAStory(topic)
    await db.requests.update({
      where: { id: request.id },
      data: { status: 'completed', result: story }
    })
    return story
  } catch (error) {
    await db.requests.update({
      where: { id: request.id },
      data: { status: 'failed', error: error.message }
    })
    throw error
  }
}
```
</CodeBlocks>

## Technical Constraints

1. Server actions must be used in files with the 'use server' directive or in server components
2. Streaming responses require client-side handling of the ReadableStream
3. Error handling should account for both BAML-specific and general errors
4. Database operations should handle both success and failure cases

## Related Documentation

- [Stream Response](./stream-response) - Details on handling streaming responses
- [Error Types](./error-types) - Complete error type reference
- [Hook Props](./hook-props) - Hook configuration options
- [Hook Result](./hook-result) - Hook return type details