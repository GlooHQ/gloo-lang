---
title: OpenAPI Generator
---

The REST/OpenAPI generator creates an OpenAPI specification for your BAML functions, allowing them to be called via HTTP endpoints.

## Configuration
<CodeBlocks>
```baml BAML
generator lang_rest_openapi {
  output_type rest/openapi
  output_dir "../openapi"
  version "0.74.0"
}
```

```txt Generated Files
baml_client/
├── openapi.yaml        # OpenAPI specification
```
</CodeBlocks>

## Generated API Structure

### Endpoints

Each BAML function is exposed as a POST endpoint at `/call/{functionName}`. For example:

<CodeBlocks>
```baml BAML
function GetDataType(text: string) -> string {
  client GPT35
  prompt #"
    What type of data is this?
  "#
}
```

```yaml openapi.yaml
/call/GetDataType:
  post:
    requestBody:
      required: true
      content:
        application/json:
          schema:
            title: GetDataTypeRequest
            type: object
            properties:
              text:
                type: string
              __baml_options__:
                nullable: true
                $ref: '#/components/schemas/BamlOptions'
            required:
              - text
    responses:
      '200':
        description: Successful operation
        content:
          application/json:
            schema:
              title: GetDataTypeResponse
              type: string
    operationId: GetDataType
```
</CodeBlocks>

### Type Mapping

BAML types are mapped to OpenAPI schema definitions:

| BAML Type | OpenAPI Type |
|-----------|--------------|
| `string` | `string` |
| `int` | `integer` |
| `float` | `number` |
| `bool` | `boolean` |
| `class` | `object` |
| `enum` | `string` with `enum` values |
| `list<T>` | `array` with `items` of type T |
| `map<K,V>` | `object` with `additionalProperties` of type V |

Example:

<CodeBlocks>
```baml BAML
class UniverseQuestion {
  question string
  confidence float
}

enum Tag {
  Security
  AI
  Blockchain
}

function AnalyzeQuestion(input: UniverseQuestion) -> Tag {
  client GPT35
  prompt #"
    Analyze the question and return the most relevant tag.
  "#
}
```

```yaml openapi.yaml
components:
  schemas:
    UniverseQuestion:
      type: object
      properties:
        question:
          type: string
        confidence:
          type: number
      required:
        - question
        - confidence

    Tag:
      type: string
      enum:
        - Security
        - AI
        - Blockchain

paths:
  /call/AnalyzeQuestion:
    post:
      requestBody:
        required: true
        content:
          application/json:
            schema:
              title: AnalyzeQuestionRequest
              type: object
              properties:
                input:
                  $ref: '#/components/schemas/UniverseQuestion'
                __baml_options__:
                  nullable: true
                  $ref: '#/components/schemas/BamlOptions'
              required:
                - input
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tag'
```
</CodeBlocks>
### BAML Options

Each request can include optional BAML-specific configuration in the `__baml_options__` field:

```yaml openapi.yaml
BamlOptions:
  type: object
  properties:
    timeout_ms:
      type: integer
      description: Request timeout in milliseconds
    retry_policy:
      type: object
      properties:
        max_retries:
          type: integer
        strategy:
          type: object
          properties:
            type:
              type: string
              enum: [exponential_backoff, constant_delay]
            delay_ms:
              type: integer
```

### Error Handling

The API follows standard HTTP status codes and includes detailed error information in the response body:

- `400`: Invalid request (e.g., validation errors)
- `408`: Request timeout
- `429`: Rate limit exceeded
- `500`: Internal server error

Error responses include:

```yaml openapi.yaml
Error:
  type: object
  properties:
    error:
      type: string
    details:
      type: object
    validation_errors:
      type: array
      items:
        type: object
        properties:
          field:
            type: string
          message:
            type: string
```

## Usage Examples

### Basic Function Call

```typescript
// Call the GetDataType function
const response = await fetch('/call/GetDataType', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    text: "This is a sample text",
    __baml_options__: {
      timeout_ms: 30000
    }
  })
});

const result = await response.json();
```

### Complex Types

```typescript
// Call the AnalyzeQuestion function with a class input
const response = await fetch('/call/AnalyzeQuestion', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    input: {
      question: "What are the security implications of LLMs?",
      confidence: 0.95
    },
    __baml_options__: {
      retry_policy: {
        max_retries: 3,
        strategy: {
          type: "exponential_backoff"
        }
      }
    }
  })
});

const tag = await response.json(); // Returns: "Security"
```

### Error Handling

```typescript
try {
  const response = await fetch('/call/GetDataType', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      // Missing required 'text' field
    })
  });

  if (!response.ok) {
    const error = await response.json();
    console.error('Error:', error);
    // {
    //   "error": "Validation Error",
    //   "validation_errors": [
    //     {
    //       "field": "text",
    //       "message": "Required field is missing"
    //     }
    //   ]
    // }
  }
} catch (error) {
  console.error('Network error:', error);
}
```

## Type Definitions

### Core Types (from `openapi.yaml`)

<ParamField
  path="BamlOptions"
  type="object"
>
  Configuration options for BAML function calls.
  ```yaml
  # Type definition
  type: object
  properties:
    timeout_ms:
      type: integer
      description: Request timeout in milliseconds
    retry_policy:
      type: object
      properties:
        max_retries:
          type: integer
        strategy:
          type: object
          properties:
            type:
              type: string
              enum: [exponential_backoff, constant_delay]
            delay_ms:
              type: integer

  # Example
  {
    "timeout_ms": 30000,
    "retry_policy": {
      "max_retries": 3,
      "strategy": {
        "type": "exponential_backoff",
        "delay_ms": 1000
      }
    }
  }
  ```
</ParamField>

<ParamField
  path="FunctionRequest"
  type="object"
>
  Generic structure for function request bodies.
  ```yaml
  # Type definition
  type: object
  properties:
    input:
      type: object
      description: Function-specific input parameters
    __baml_options__:
      nullable: true
      $ref: '#/components/schemas/BamlOptions'
  required:
    - input

  # Example - Simple input
  {
    "text": "What is BAML?",
    "__baml_options__": {
      "timeout_ms": 30000
    }
  }

  # Example - Complex input
  {
    "input": {
      "question": "What are the security implications of LLMs?",
      "confidence": 0.95
    },
    "__baml_options__": {
      "timeout_ms": 30000
    }
  }
  ```
</ParamField>

### Error Types (from `openapi.yaml`)

<ParamField
  path="Error"
  type="object"
>
  Standard error response structure.
  ```yaml
  # Type definition
  type: object
  properties:
    error:
      type: string
    details:
      type: object
    validation_errors:
      type: array
      items:
        type: object
        properties:
          field:
            type: string
          message:
            type: string

  # Example - Validation error
  {
    "error": "Validation Error",
    "validation_errors": [
      {
        "field": "text",
        "message": "Required field is missing"
      }
    ]
  }

  # Example - Runtime error
  {
    "error": "Internal Server Error",
    "details": {
      "message": "LLM service unavailable",
      "code": "SERVICE_ERROR"
    }
  }
  ```
</ParamField>

### Schema Types (from `openapi.yaml`)

<ParamField
  path="ClassDefinition"
  type="object"
>
  OpenAPI schema for BAML class definitions.
  ```yaml
  # Type definition
  type: object
  properties:
    type:
      type: string
      const: object
    properties:
      type: object
    required:
      type: array
      items:
        type: string

  # Example - UniverseQuestion class
  type: object
  properties:
    question:
      type: string
    confidence:
      type: number
  required:
    - question
    - confidence
  ```
</ParamField>

<ParamField
  path="EnumDefinition"
  type="object"
>
  OpenAPI schema for BAML enum definitions.
  ```yaml
  # Type definition
  type: object
  properties:
    type:
      type: string
      const: string
    enum:
      type: array
      items:
        type: string

  # Example - Tag enum
  type: string
  enum:
    - Security
    - AI
    - Blockchain
  ```
</ParamField>

<ParamField
  path="StreamResponse"
  type="object"
>
  Structure for streaming responses.
  ```yaml
  # Type definition
  type: object
  properties:
    type:
      type: string
      const: object
    properties:
      partial:
        type: object
        description: Partial response data
      final:
        type: object
        description: Final complete response
      error:
        $ref: '#/components/schemas/Error'

  # Example - Text streaming response
  {
    "partial": "The capital of France",
    "final": "The capital of France is Paris",
    "error": null
  }
  ```
</ParamField>